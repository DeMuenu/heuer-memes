<!DOCTYPE html>
<html>
<head>
    <title>PyScript Twitter-Ã¤hnliche Seite</title>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
</head>

<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f0f2f5;
    color: #333;
    margin: 0;
    padding: 20px;
}

h1 {
    color: #1a8cff;
}

form {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

input[type="text"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-sizing: border-box;
}

button {
    background-color: #1a8cff;
    color: white;
    border: none;
    padding: 10px 20px;
    text-transform: uppercase;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
}

button:hover {
    background-color: #0f7ae5;
}

#posts {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

#posts div {
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
    margin-bottom: 15px;
}

#posts p {
    margin: 0;
}

</style>

<body>

    <py-script>
        # Hier kommt der Python-Code
    </py-script>

    <h1>Mini-Twitter mit PyScript</h1>

    <form py-submit="load_post()" onsubmit="return false">
        <input type="text" id="password" placeholder="Was gibt's Neues?">
        <button type="submit">Posten</button>
    </form>

    <div id="posts">
        <!-- Hier werden die Posts angezeigt -->
    </div>

</body>
<py-script>
from js import fetch, JSON
import asyncio

async def load_post():
    print("sent")
    post_content = Element('password').element.value
    response = await fetch('http://127.0.0.1:5000/post', {
        'method': 'POST',
        'headers': {'Content-Type': 'application/json'},
        'body': JSON.stringify({'content': post_content})
    })

    if response.status == 200:
        
        new_post = f'<div><p>{post_content}</p></div>'
        Element('posts').element.innerHTML += new_post
        Element('password').element.value = ''  # Clear the input field
    print("no Responce")
    print(response)

    asyncio.ensure_future(load_post)
</py-script> 

</html>
